<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harmony - Modern Music Player</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            color: #fff;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        .container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .sidebar {
            width: 240px;
            background: rgba(0, 0, 0, 0.85);
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 25px;
            backdrop-filter: blur(10px);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
            z-index: 10;
        }

        .sidebar .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 28px;
            font-weight: bold;
            color: #1db954;
            padding-bottom: 15px;
            border-bottom: 1px solid #333;
        }

        .logo i {
            font-size: 32px;
        }

        .sidebar nav ul {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .sidebar nav ul li a {
            color: #b3b3b3;
            text-decoration: none;
            font-size: 18px;
            padding: 12px 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s;
            border-radius: 8px;
        }

        .sidebar nav ul li a:hover,
        .sidebar nav ul li a.active {
            color: #fff;
            background: linear-gradient(to right, #1db954, #1ed760);
            box-shadow: 0 4px 15px rgba(29, 185, 84, 0.3);
            transform: translateX(5px);
        }

        .sidebar nav ul li a i {
            font-size: 20px;
            width: 24px;
            text-align: center;
        }

        .library-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #333;
        }

        .library-section h3 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #1db954;
        }

        .library-section ul {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .library-section ul li {
            padding: 10px 15px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .library-section ul li:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .library-section ul li i {
            color: #1db954;
        }

        .main-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            background: rgba(18, 18, 18, 0.9);
            backdrop-filter: blur(10px);
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #333;
        }

        .header h1 {
            font-size: 36px;
            background: linear-gradient(to right, #1db954, #fff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
        }

        .search-bar {
            display: flex;
            align-items: center;
            background: rgba(40, 40, 40, 0.8);
            padding: 10px 20px;
            border-radius: 30px;
            width: 300px;
            transition: all 0.3s;
        }

        .search-bar:hover {
            background: rgba(60, 60, 60, 0.8);
        }

        .search-bar input {
            background: none;
            border: none;
            color: #fff;
            outline: none;
            padding: 5px;
            width: 100%;
            font-size: 16px;
        }

        .search-bar i {
            color: #b3b3b3;
            font-size: 18px;
        }

        .filter-section {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .filter-section select {
            background: rgba(40, 40, 40, 0.8);
            color: #fff;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
        }

        .filter-section select:focus {
            outline: none;
            background: rgba(60, 60, 60, 0.8);
        }

        .section-title {
            font-size: 24px;
            margin: 25px 0 20px;
            color: #1db954;
        }

        .playlist-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .playlist-card {
            background: linear-gradient(145deg, #282828, #1f1f1f);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }

        .playlist-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.6);
            background: linear-gradient(145deg, #333, #252525);
        }

        .playlist-card:hover .play-icon {
            opacity: 1;
            transform: translateY(0);
        }

        .playlist-card img {
            width: 100%;
            border-radius: 8px;
            margin-bottom: 15px;
            aspect-ratio: 1/1;
            object-fit: cover;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
        }

        .playlist-card h3 {
            font-size: 18px;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .playlist-card p {
            font-size: 14px;
            color: #b3b3b3;
        }

        .play-icon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, 20px);
            background: #1db954;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
        }

        .play-icon i {
            color: #000;
            font-size: 20px;
            margin-left: 4px;
        }

        .player {
            background: linear-gradient(to right, #000, #1a1a1a);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid #333;
            min-height: 90px;
            box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.5);
            z-index: 100;
        }

        .player .track-info {
            display: flex;
            align-items: center;
            gap: 15px;
            min-width: 220px;
        }

        .player .track-info img {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            object-fit: cover;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
        }

        .player .track-info div {
            display: flex;
            flex-direction: column;
        }

        .player .track-info h4 {
            font-size: 16px;
            white-space: nowrap;
        }

        .player .track-info p {
            font-size: 14px;
            color: #b3b3b3;
        }

        .player-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            flex: 1;
            max-width: 600px;
        }

        .player-controls .controls {
            display: flex;
            gap: 25px;
            align-items: center;
        }

        .player-controls button {
            background: none;
            border: none;
            color: #fff;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .player-controls button:hover {
            color: #1db954;
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.1);
        }

        .player-controls .play-pause-btn {
            background: #fff;
            color: #000;
            width: 50px;
            height: 50px;
        }

        .player-controls .play-pause-btn:hover {
            background: #1db954;
            color: #fff;
            transform: scale(1.1);
        }

        .player-controls .active {
            color: #1db954;
            background: rgba(255, 255, 255, 0.1);
        }

        .progress-bar {
            width: 100%;
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 14px;
            color: #b3b3b3;
        }

        .progress-bar input {
            flex: 1;
            height: 5px;
            accent-color: #1db954;
            cursor: pointer;
            border-radius: 10px;
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 180px;
        }

        .volume-control i {
            font-size: 20px;
            color: #1db954;
        }

        .volume-control input {
            width: 120px;
            accent-color: #1db954;
            cursor: pointer;
        }

        .now-playing {
            margin-top: 20px;
            padding-top: 20px;
            border-top:  ูุง

        .now-playing h3 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #1db954;
        }

        .now-playing .current-track {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 10px;
            border-radius: 8px;
            background: rgba(40, 40, 40, 0.5);
        }

        .now-playing .current-track img {
            width: 50px;
            height: 50px;
            border-radius: 6px;
        }

        .now-playing .current-track-info h4 {
            font-size: 16px;
            margin-bottom: 5px;
        }

        .now-playing .current-track-info p {
            font-size: 14px;
            color: #b3b3b3;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: #282828;
            padding: 20px;
            border-radius: 10px;
            width: 400px;
            max-width: 90%;
        }

        .modal-content h2 {
            color: #1db954;
            margin-bottom: 20px;
        }

        .modal-content input {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #fff;
            border-radius: 5px;
        }

        .modal-content button {
            background: #1db954;
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            margin: 5px;
        }

        .modal-content button:hover {
            background: #1ed760;
        }

        /* Responsive Design */
        @media (max-width: 900px) {
            .sidebar {
                width: 80px;
                align-items: center;
                padding: 20px 10px;
            }
            
            .sidebar .logo span,
            .sidebar nav ul li a span,
            .library-section h3,
            .library-section ul li span,
            .now-playing {
                display: none;
            }
            
            .sidebar nav ul li a {
                justify-content: center;
                padding: 15px;
            }
            
            .playlist-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            .header {
                flex-direction: column;
                gap: 20px;
                align-items: flex-start;
            }
            
            .search-bar {
                width: 100%;
            }
            
            .player {
                flex-direction: column;
                gap: 20px;
                padding: 20px;
            }
            
            .player .track-info {
                width: 100%;
                justify-content: center;
            }
            
            .volume-control {
                width: 100%;
                justify-content: center;
            }
        }
        
        @media (max-width: 600px) {
            .playlist-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .sidebar {
                position: fixed;
                left: -80px;
                height: 100%;
                z-index: 1000;
            }
            
            .sidebar.active {
                left: 0;
            }
            
            .menu-toggle {
                position: fixed;
                top: 20px;
                left: 20px;
                z-index: 1001;
                background: #1db954;
                width: 40px;
                height: 40px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                color: #000;
                font-size: 20px;
                cursor: pointer;
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            }
        }
    </style>
</head>
<body>
    <div class="menu-toggle" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
    </div>
    
    <div class="container">
        <div class="sidebar">
            <div class="logo">
                <i class="fas fa-music"></i>
                <span>Harmony</span>
            </div>
            <nav>
                <ul>
                    <li><a href="#" class="active"><i class="fas fa-home"></i><span>Home</span></a></li>
                    <li><a href="#"><i class="fas fa-search"></i><span>Search</span></a></li>
                    <li><a href="#"><i class="fas fa-book"></i><span>Your Library</span></a></li>
                    <li><a href="#" onclick="showCreatePlaylistModal()"><i class="fas fa-plus"></i><span>Create Playlist</span></a></li>
                </ul>
            </nav>
            
            <div class="library-section">
                <h3>Your Library</h3>
                <ul id="custom-playlists">
                    <li><i class="fas fa-heart"></i><span>Liked Songs</span></li>
                    <li><i class="fas fa-compact-disc"></i><span>Recently Played</span></li>
                    <li><i class="fas fa-history"></i><span>History</span></li>
                    <li><i class="fas fa-star"></i><span>Favorites</span></li>
                </ul>
            </div>
            
            <div class="now-playing">
                <h3>Now Playing</h3>
                <div class="current-track">
                    <img src="https://i.ytimg.com/vi/8hly31xKli0/maxresdefault.jpg" alt="Current Track" id="sidebar-track-image">
                    <div class="current-track-info">
                        <h4 id="sidebar-track-title">No song playing</h4>
                        <p id="sidebar-track-artist">Unknown Artist</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="header">
                <h1>Discover New Music</h1>
                <div class="search-bar">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Search for songs, artists, or playlists..." id="search-input">
                </div>
            </div>
            
            <div class="filter-section">
                <select id="genre-filter">
                    <option value="">All Genres</option>
                    <option value="Pop">Pop</option>
                    <option value="Pop Rock">Pop Rock</option>
                    <option value="Hip-Hop">Hip-Hop</option>
                    <option value="R&B">R&B</option>
                    <option value="K-Pop">K-Pop</option>
                    <option value="Indie Pop">Indie Pop</option>
                    <option value="Soul">Soul</option>
                    <option value="Afrobeats">Afrobeats</option>
                </select>
                <select id="sort-filter">
                    <option value="title">Sort by: Title</option>
                    <option value="artist">Sort by: Artist</option>
                </select>
            </div>
            
            <h2 class="section-title">Featured Playlists</h2>
            <div class="playlist-grid" id="playlist-grid">
                <!-- Playlist cards will be generated dynamically -->
            </div>
            
            <h2 class="section-title">Recently Played</h2>
            <div class="playlist-grid" id="recent-grid">
                <!-- Recent tracks will be generated dynamically -->
            </div>
        </div>
    </div>
    
    <div class="player">
        <div class="track-info">
            <img src="" alt="Track Image" id="track-image">
            <div>
                <h4 id="track-title">No song playing</h4>
                <p id="track-artist">Select a playlist to start</p>
            </div>
        </div>
        <div class="player-controls">
            <div class="controls">
                <button id="shuffle-btn" onclick="toggleShuffle()"><i class="fas fa-random"></i></button>
                <button onclick="previousTrack()"><i class="fas fa-step-backward"></i></button>
                <button onclick="togglePlay()" class="play-pause-btn" id="play-pause"><i class="fas fa-play"></i></button>
                <button onclick="nextTrack()"><i class="fas fa-step-forward"></i></button>
                <button id="repeat-btn" onclick="toggleRepeat()"><i class="fas fa-redo"></i></button>
            </div>
            <div class="progress-bar">
                <span id="current-time">0:00</span>
                <input type="range" id="progress" min="0" max="100" value="0">
                <span id="duration">0:00</span>
            </div>
        </div>
        <div class="volume-control">
            <i class="fas fa-volume-up"></i>
            <input type="range" id="volume" min="0" max="1" step="0.01" value="0.7">
        </div>
    </div>

    <div class="modal" id="create-playlist-modal">
        <div class="modal-content">
            <h2>Create New Playlist</h2>
            <input type="text" id="playlist-name" placeholder="Playlist Name">
            <input type="text" id="playlist-desc" placeholder="Description">
            <div>
                <button onclick="createPlaylist()">Create</button>
                <button onclick="closeModal()">Cancel</button>
            </div>
        </div>
    </div>

    <audio id="audio-player"></audio>

    <script>
        // DOM Elements
        const audioPlayer = document.getElementById('audio-player');
        const playPauseBtn = document.getElementById('play-pause');
        const progress = document.getElementById('progress');
        const currentTime = document.getElementById('current-time');
        const duration = document.getElementById('duration');
        const volume = document.getElementById('volume');
        const trackTitle = document.getElementById('track-title');
        const trackArtist = document.getElementById('track-artist');
        const trackImage = document.getElementById('track-image');
        const sidebarTrackTitle = document.getElementById('sidebar-track-title');
        const sidebarTrackArtist = document.getElementById('sidebar-track-artist');
        const sidebarTrackImage = document.getElementById('sidebar-track-image');
        const searchInput = document.getElementById('search-input');
        const playlistGrid = document.getElementById('playlist-grid');
        const recentGrid = document.getElementById('recent-grid');
        const navLinks = document.querySelectorAll('.sidebar nav ul li a');
        const genreFilter = document.getElementById('genre-filter');
        const sortFilter = document.getElementById('sort-filter');
        const shuffleBtn = document.getElementById('shuffle-btn');
        const repeatBtn = document.getElementById('repeat-btn');
        const customPlaylists = document.getElementById('custom-playlists');
        const createPlaylistModal = document.getElementById('create-playlist-modal');

        // Tracks data with actual audio URLs
        const tracks = [
            { title: 'Blinding Lights', artist: 'The Weeknd', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3', image: 'https://i.scdn.co/image/ab67616d0000b2738863bc11d2aa12b54f5aeb36', genre: 'Pop' },
            { title: 'Save Your Tears', artist: 'The Weeknd', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3', image: 'https://i.scdn.co/image/ab67616d0000b2738863bc11d2aa12b54f5aeb36', genre: 'Pop' },
            { title: 'Levitating', artist: 'Dua Lipa', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3', image: 'https://i.scdn.co/image/ab67616d0000b273e6f407c7f3a0ec98845e4431', genre: 'Pop' },
            { title: 'Stay', artist: 'The Kid LAROI, Justin Bieber', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3', image: 'https://i.scdn.co/image/ab67616d0000b273c5649add07ed3720be9d5526', genre: 'Pop' },
            { title: 'Good 4 U', artist: 'Olivia Rodrigo', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3', image: 'https://i.scdn.co/image/ab67616d0000b27318d0ed4f969b376893f9a38f', genre: 'Pop Rock' },
            { title: 'Montero', artist: 'Lil Nas X', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3', image: 'https://i.scdn.co/image/ab67616d0000b2734a6c0376235e5aa44e59d2c2', genre: 'Hip-Hop' },
            { title: 'Peaches', artist: 'Justin Bieber', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-7.mp3', image: 'https://i.scdn.co/image/ab67616d0000b273d4daf28d55fe4197ede848be', genre: 'R&B' },
            { title: 'Kiss Me More', artist: 'Doja Cat ft. SZA', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-8.mp3', image: 'https://i.scdn.co/image/ab67616d0000b273e6f407c7f3a0ec98845e4431', genre: 'Pop' },
            { title: 'Butter', artist: 'BTS', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-9.mp3', image: 'https://i.scdn.co/image/ab67616d0000b27317db30ce3f081d6818a8ad49', genre: 'K-Pop' },
            { title: 'Industry Baby', artist: 'Lil Nas X', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-10.mp3', image: 'https://i.scdn.co/image/ab67616d0000b2734a6c0376235e5aa44e59d2c2', genre: 'Hip-Hop' },
            { title: 'Stay', artist: 'Post Malone', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-11.mp3', image: 'https://i.scdn.co/image/ab67616d0000b273e1d9c6600e36a3f5bafb41a5', genre: 'Pop' },
            { title: 'Heat Waves', artist: 'Glass Animals', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-12.mp3', image: 'https://i.scdn.co/image/ab67616d0000b273f7db43292a6a99b21b51d5b4', genre: 'Indie Pop' },
            { title: 'Easy On Me', artist: 'Adele', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-13.mp3', image: 'https://i.scdn.co/image/ab67616d0000b273d4daf28d55fe4197ede848be', genre: 'Soul' },
            { title: 'Shivers', artist: 'Ed Sheeran', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-14.mp3', image: 'https://i.scdn.co/image/ab67616d0000b2734a6c0376235e5aa44e59d2c2', genre: 'Pop' },
            { title: 'Cold Heart', artist: 'Elton John, Dua Lipa', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-15.mp3', image: 'https://i.scdn.co/image/ab67616d0000b273e6f407c7f3a0ec98845e4431', genre: 'Pop' },
            { title: 'Bad Habits', artist: 'Ed Sheeran', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-16.mp3', image: 'https://i.scdn.co/image/ab67616d0000b2734a6c0376235e5aa44e59d2c2', genre: 'Pop' },
            { title: 'Woman', artist: 'Doja Cat', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-17.mp3', image: 'https://i.scdn.co/image/ab67616d0000b273e6f407c7f3a0ec98845e4431', genre: 'R&B' },
            { title: 'Need to Know', artist: 'Doja Cat', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-18.mp3', image: 'https://i.scdn.co/image/ab67616d0000b273e6f407c7f3a0ec98845e4431', genre: 'R&B' },
            { title: 'Love Nwantiti', artist: 'CKay', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-19.mp3', image: 'https://i.scdn.co/image/ab67616d0000b273d4daf28d55fe4197ede848be', genre: 'Afrobeats' },
            { title: 'STAY', artist: 'The Kid LAROI', src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-20.mp3', image: 'https://i.scdn.co/image/ab67616d0000b273c5649add07ed3720be9d5526', genre: 'Pop' }
        ];

        // Player state
        let currentTrack = 0;
        let isPlaying = false;
        let isShuffling = false;
        let isRepeating = false;
        let recentTracks = [];
        let customPlaylistsData = [];
        let currentPlaylistTracks = tracks; // Tracks to play from (default or custom playlist)

        // Initialize the player
        function initPlayer() {
            renderPlaylists();
            renderRecentTracks();
            renderCustomPlaylists();
            
            // Set active class on sidebar navigation
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    navLinks.forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    const section = this.querySelector('span').textContent;
                    document.querySelector('.header h1').textContent = section;
                    
                    // Reset to default tracks when navigating to Home or Search
                    if (section === 'Home' || section === 'Search') {
                        currentPlaylistTracks = tracks;
                        renderPlaylists();
                    }
                });
            });
            
            // Set volume
            audioPlayer.volume = volume.value;
            
            // Load first track
            loadTrack(currentTrack);
            
            // Filter and sort event listeners
            genreFilter.addEventListener('change', filterAndSortTracks);
            sortFilter.addEventListener('change', filterAndSortTracks);
        }

        // Render playlist cards
        function renderPlaylists() {
            playlistGrid.innerHTML = '';
            
            const featuredPlaylists = [
                { name: 'Chill Hits', desc: 'Relaxing Pop', img: 'https://i.ytimg.com/vi/8hly31xKli0/maxresdefault.jpg', genre: 'Pop' },
                { name: 'Lo-Fi Beats', desc: 'Study & Chill', img: 'https://i.ytimg.com/vi/5qap5aO4i9A/maxresdefault.jpg', genre: 'Indie Pop' },
                { name: 'Pop Mix', desc: 'Top Hits', img: 'https://i.ytimg.com/vi/jfKfPfyJRdk/maxresdefault.jpg', genre: 'Pop' },
                { name: 'Rock Classics', desc: 'Legendary Tracks', img: 'https://i.ytimg.com/vi/7wtfhZwyrcc/maxresdefault.jpg', genre: 'Pop Rock' },
                { name: 'Hip-Hop Vibes', desc: 'Urban Beats', img: 'https://i.ytimg.com/vi/Edwsf-8F3sI/maxresdefault.jpg', genre: 'Hip-Hop' },
                { name: 'Electronic Dance', desc: 'EDM Party', img: 'https://i.ytimg.com/vi/GlCmAC4MHek/maxresdefault.jpg', genre: 'Pop' },
                { name: 'Jazz Lounge', desc: 'Smooth Jazz', img: 'https://i.ytimg.com/vi/9Sc-ir2UwGU/maxresdefault.jpg', genre: 'Soul' },
                { name: 'Indie Folk', desc: 'Acoustic Vibes', img: 'https://i.ytimg.com/vi/0J2QdDbelmY/maxresdefault.jpg', genre: 'Indie Pop' },
                { name: 'R&B Soul', desc: 'Soulful Grooves', img: 'https://i.ytimg.com/vi/4NRXx6U8ABQ/maxresdefault.jpg', genre: 'R&B' },
                { name: 'Classical Serenity', desc: 'Orchestral Bliss', img: 'https://i.ytimg.com/vi/3MteSlpxCpo/maxresdefault.jpg', genre: 'Soul' }
            ];
            
            const playlistsToShow = document.querySelector('.header h1').textContent === 'Your Library' ? customPlaylistsData : featuredPlaylists;
            
            playlistsToShow.forEach((playlist, index) => {
                const card = document.createElement('div');
                card.className = 'playlist-card';
                card.innerHTML = `
                    <img src="${playlist.img}" alt="${playlist.name}">
                    <div class="play-icon">
                        <i class="fas fa-play"></i>
                    </div>
                    <h3>${playlist.name}</h3>
                    <p>${playlist.desc}</p>
                `;
                card.onclick = () => {
                    if (document.querySelector('.header h1').textContent === 'Your Library') {
                        currentPlaylistTracks = playlist.tracks;
                        renderPlaylistTracks(playlist.tracks);
                    } else {
                        const genreTracks = tracks.filter(t => t.genre.toLowerCase().includes(playlist.genre.toLowerCase()));
                        if (genreTracks.length > 0) {
                            const randomIndex = Math.floor(Math.random() * genreTracks.length);
                            const trackIndex = tracks.findIndex(t => t.title === genreTracks[randomIndex].title);
                            loadTrack(trackIndex);
                            togglePlay();
                        }
                    }
                };
                playlistGrid.appendChild(card);
            });
        }

        // Render custom playlists in sidebar
        function renderCustomPlaylists() {
            const defaultItems = `
                <li><i class="fas fa-heart"></i><span>Liked Songs</span></li>
                <li><i class="fas fa-compact-disc"></i><span>Recently Played</span></li>
                <li><i class="fas fa-history"></i><span>History</span></li>
                <li><i class="fas fa-star"></i><span>Favorites</span></li>
            `;
            customPlaylists.innerHTML = defaultItems;
            
            customPlaylistsData.forEach(playlist => {
                const li = document.createElement('li');
                li.innerHTML = `<i class="fas fa-list"></i><span>${playlist.name}</span>`;
                li.onclick = () => {
                    navLinks.forEach(l => l.classList.remove('active'));
                    document.querySelector('.header h1').textContent = 'Your Library';
                    currentPlaylistTracks = playlist.tracks;
                    renderPlaylists();
                };
                customPlaylists.appendChild(li);
            });
        }

        // Render tracks for a specific playlist
        function renderPlaylistTracks(playlistTracks) {
            playlistGrid.innerHTML = '';
            filterAndSortTracks(playlistTracks).forEach(track => {
                const card = document.createElement('div');
                card.className = 'playlist-card';
                card.innerHTML = `
                    <img src="${track.image}" alt="${track.title}">
                    <div class="play-icon">
                        <i class="fas fa-play"></i>
                    </div>
                    <h3>${track.title}</h3>
                    <p>${track.artist}</p>
                `;
                card.onclick = () => {
                    const trackIndex = tracks.findIndex(t => t.title === track.title);
                    loadTrack(trackIndex);
                    if (!isPlaying) togglePlay();
                };
                playlistGrid.appendChild(card);
            });
        }

        // Render recent tracks
        function renderRecentTracks() {
            recentGrid.innerHTML = '';
            
            const recentToShow = recentTracks.slice(-4).reverse();
            
            if (recentToShow.length === 0) {
                recentGrid.innerHTML = '<p style="grid-column:1/-1; text-align:center; padding:20px;">No recently played tracks</p>';
                return;
            }
            
            recentToShow.forEach(trackId => {
                const track = tracks[trackId];
                const card = document.createElement('div');
                card.className = 'playlist-card';
                card.innerHTML = `
                    <img src="${track.image}" alt="${track.title}">
                    <div class="play-icon">
                        <i class="fas fa-play"></i>
                    </div>
                    <h3>${track.title}</h3>
                    <p>${track.artist}</p>
                `;
                card.onclick = () => {
                    loadTrack(trackId);
                    if (!isPlaying) togglePlay();
                };
                recentGrid.appendChild(card);
            });
        }

        // Load a track
        function loadTrack(index) {
            if (index < 0 || index >= currentPlaylistTracks.length) return;
            
            currentTrack = index;
            const track = currentPlaylistTracks[index];
            
            // Update track info
            trackTitle.textContent = track.title;
            trackArtist.textContent = track.artist;
            trackImage.src = track.image;
            
            // Update sidebar now playing
            sidebarTrackTitle.textContent = track.title;
            sidebarTrackArtist.textContent = track.artist;
            sidebarTrackImage.src = track.image;
            
            // Set audio source
            audioPlayer.src = track.src;
            
            // Add to recent tracks
            const globalIndex = tracks.findIndex(t => t.title === track.title);
            if (!recentTracks.includes(globalIndex)) {
                recentTracks.push(globalIndex);
                if (recentTracks.length > 10) recentTracks.shift();
                renderRecentTracks();
            }
            
            // Reset progress
            progress.value = 0;
            currentTime.textContent = '0:00';
            
            // Auto-play if player was playing
            if (isPlaying) {
                audioPlayer.play().then(() => {
                    playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                }).catch(error => {
                    console.error('Playback failed: ', error);
                    isPlaying = false;
                    playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                });
            }
        }

        // Toggle play/pause
        function togglePlay() {
            if (audioPlayer.src === '') {
                loadTrack(0);
            }
            
            if (isPlaying) {
                audioPlayer.pause();
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
            } else {
                audioPlayer.play().then(() => {
                    playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                }).catch(error => {
                    console.error('Playback failed: ', error);
                });
            }
            isPlaying = !isPlaying;
        }

        // Next track
        function nextTrack() {
            if (isShuffling) {
                currentTrack = Math.floor(Math.random() * currentPlaylistTracks.length);
            } else {
                currentTrack = (currentTrack + 1) % currentPlaylistTracks.length;
            }
            loadTrack(currentTrack);
            if (!isPlaying) togglePlay();
        }

        // Previous track
        function previousTrack() {
            if (isShuffling) {
                currentTrack = Math.floor(Math.random() * currentPlaylistTracks.length);
            } else {
                currentTrack = (currentTrack - 1 + currentPlaylistTracks.length) % currentPlaylistTracks.length;
            }
            loadTrack(currentTrack);
            if (!isPlaying) togglePlay();
        }

        // Toggle shuffle
        function toggleShuffle() {
            isShuffling = !isShuffling;
            shuffleBtn.classList.toggle('active');
        }

        // Toggle repeat
        function toggleRepeat() {
            isRepeating = !isRepeating;
            repeatBtn.classList.toggle('active');
            audioPlayer.loop = isRepeating;
        }

        // Toggle sidebar on mobile
        function toggleSidebar() {
            document.querySelector('.sidebar').classList.toggle('active');
        }

        // Show create playlist modal
        function showCreatePlaylistModal() {
            createPlaylistModal.style.display = 'flex';
        }

        // Close modal
        function closeModal() {
            createPlaylistModal.style.display = 'none';
            document.getElementById('playlist-name').value = '';
            document.getElementById('playlist-desc').value = '';
        }

        // Create new playlist
        function createPlaylist() {
            const name = document.getElementById('playlist-name').value.trim();
            const desc = document.getElementById('playlist-desc').value.trim();
            
            if (name) {
                customPlaylistsData.push({
                    name,
                    desc: desc || 'Custom Playlist',
                    img: 'https://i.ytimg.com/vi/8hly31xKli0/maxresdefault.jpg',
                    tracks: []
                });
                renderCustomPlaylists();
                closeModal();
            }
        }

        // Filter and sort tracks
        function filterAndSortTracks(trackList = currentPlaylistTracks) {
            let filteredTracks = [...trackList];
            
            // Apply genre filter
            const genre = genreFilter.value;
            if (genre) {
                filteredTracks = filteredTracks.filter(t => t.genre === genre);
            }
            
            // Apply search filter
            const searchTerm = searchInput.value.toLowerCase();
            if (searchTerm) {
                filteredTracks = filteredTracks.filter(t => 
                    t.title.toLowerCase().includes(searchTerm) || 
                    t.artist.toLowerCase().includes(searchTerm)
                );
            }
            
            // Apply sorting
            const sortBy = sortFilter.value;
            filteredTracks.sort((a, b) => {
                if (sortBy === 'title') {
                    return a.title.localeCompare(b.title);
                } else {
                    return a.artist.localeCompare(b.artist);
                }
            });
            
            return filteredTracks;
        }

        // Event listeners
        audioPlayer.addEventListener('timeupdate', () => {
            const current = audioPlayer.currentTime;
            const total = audioPlayer.duration;
            
            if (!isNaN(total)) {
                progress.value = (current / total) * 100;
                currentTime.textContent = formatTime(current);
                duration.textContent = formatTime(total);
            }
        });

        audioPlayer.addEventListener('ended', () => {
            if (isRepeating) {
                audioPlayer.currentTime = 0;
                audioPlayer.play();
            } else {
                nextTrack();
            }
        });

        progress.addEventListener('input', () => {
            audioPlayer.currentTime = (progress.value / 100) * audioPlayer.duration;
        });

        volume.addEventListener('input', () => {
            audioPlayer.volume = volume.value;
        });

        searchInput.addEventListener('input', () => {
            if (document.querySelector('.header h1').textContent === 'Your Library') {
                renderPlaylistTracks(currentPlaylistTracks);
            } else {
                renderPlaylists();
            }
        });

        // Format time (MM:SS)
        function formatTime(seconds) {
            const min = Math.floor(seconds / 60);
            const sec = Math.floor(seconds % 60);
            return `${min}:${sec < 10 ? '0' : ''}${sec}`;
        }

        // Initialize the player when page loads
        window.onload = initPlayer;
    </script>
</body>
</html>